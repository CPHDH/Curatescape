/*
 * jQuery mmenu columns add-on
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
!function(s){var i="mmenu",e="columns";s[i].addons[e]={setup:function(){var t=this.opts[e];this.conf[e];if(l=s[i].glbl,"boolean"==typeof t&&(t={add:t}),"number"==typeof t&&(t={add:!0,visible:t}),"object"!=typeof t&&(t={}),"number"==typeof t.visible&&(t.visible={min:t.visible,max:t.visible}),t=this.opts[e]=s.extend(!0,{},s[i].defaults[e],t),t.add){t.visible.min=Math.max(1,Math.min(6,t.visible.min)),t.visible.max=Math.max(t.visible.min,Math.min(6,t.visible.max));for(var a=this.opts.offCanvas?this.$menu.add(l.$html):this.$menu,o="",d=0;d<=t.visible.max;d++)o+=" "+n.columns+"-"+d;o.length&&(o=o.slice(1));var h=function(s){var i=this.$pnls.children("."+n.subopened).length;s&&!s.hasClass(n.subopened)&&i++,i=Math.min(t.visible.max,Math.max(t.visible.min,i)),a.removeClass(o).addClass(n.columns+"-"+i)},m=function(){a.removeClass(o)},r=function(i){this.$pnls.children("."+n.panel).removeClass(o).filter("."+n.subopened).add(i).slice(-t.visible.max).each(function(i){s(this).addClass(n.columns+"-"+i)})};this.bind("initMenu:after",function(){this.$menu.addClass(n.columns)}),this.bind("initPanels:after",function(s){r.call(this,this.$pnls.children("."+n.opened))}),this.bind("open:start",h),this.bind("openPanel:start",h),this.bind("openPanel:start",r),this.bind("close:finish",m),this.opts.offCanvas||h.call(this)}},add:function(){n=s[i]._c,t=s[i]._d,a=s[i]._e,n.add("columns")},clickAnchor:function(i,t){if(!this.opts[e].add)return!1;if(t){var a=i.attr("href");if(a.length>1&&"#"==a.slice(0,1))try{var l=s(a,this.$menu);if(l.is("."+n.panel))for(var o=parseInt(i.closest("."+n.panel).attr("class").split(n.columns+"-")[1].split(" ")[0],10)+1;o>0;){var d=this.$pnls.children("."+n.columns+"-"+o);if(!d.length){o=-1;break}o++,d.removeClass(n.subopened).removeClass(n.opened).removeClass(n.highest).addClass(n.hidden)}}catch(h){}}}},s[i].defaults[e]={add:!1,visible:{min:1,max:3}};var n,t,a,l}(jQuery);